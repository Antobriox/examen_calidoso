{% extends 'layout.html' %}
{% block title %}Ver Tema{% endblock %}
{% block content %}
<div class="container">
    <h1>{{ tema.titulo }}</h1>
    <p>{{ tema.descripcion }}</p>
    <small>Creado por: {{ tema.usuario.nombre_usuario }} el {{ tema.fecha_creacion }}</small>

    <!-- Mostrar el promedio de calificaciones -->
    <h2>Calificación Promedio: {{ promedio_calificaciones|default(0)|round(2) }}</h2>

    <h2>Respuestas</h2>
    <ul class="list-group">
        {% for respuesta in respuestas %}
            <li class="list-group-item">
                <p>{{ respuesta.contenido }} - <strong>{{ respuesta.usuario.nombre_usuario }}</strong></p>
                <p>Calificación: {{ respuesta.calificacion }} estrellas</p>
            </li>
        {% endfor %}
    </ul>
    <form action="{{ url_for('agregar_respuesta', id_tema=tema.id) }}" method="POST" class="mt-3">
        <div class="form-group">
            <label for="contenido">Añadir Respuesta:</label>
            <textarea id="contenido" name="contenido" class="form-control" required></textarea>
        </div>
        <div class="form-group">
            <label for="calificacion">Calificación (1 a 5 estrellas):</label>
            <select id="calificacion" name="calificacion" class="form-control" required>
                <option value="1">1 estrella</option>
                <option value="2">2 estrellas</option>
                <option value="3">3 estrellas</option>
                <option value="4">4 estrellas</option>
                <option value="5">5 estrellas</option>
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Agregar Respuesta y Calificación</button>
    </form>
    <a href="{{ url_for('home') }}" class="btn btn-secondary mt-3">Volver</a>
</div>
{% endblock %}
